# vim:tw=0:ts=2:sw=2:et:norl
# Author: Landon Bouma <https://tallybark.com/>
# Project: https://github.com/doblabs/easy-as-pypi#ðŸ¥§
# License: MIT

---

name: Release Cascade Versioner

on:

  # CXREF:
  # https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows#
  #          running-your-pull_request-workflow-when-a-pull-request-merges
  # - Note pull_request, not pull_request_target, because (don't need/want) permissions.
  pull_request:
    types:
      - closed

# env:
#   # USYNC: https://github.com/actions/python-versions/releases
#   # - USYNC: PYTHON_VERSION usage in .github/workflows/*.
#   PYTHON_VERSION: 3.11

jobs:
  blather:
    name: Blather
    runs-on: ubuntu-latest
    steps:
      - name: Dump github.event
        run: echo "${{ toJson(github.event) }}"

  # ***

  if_merged:
    if: github.event.pull_request.merged == true
    runs-on: ubuntu-latest
    steps:
      - run: |
          echo "The PR was merged"

      # FIXME: Inspect dump for something to ID PR as update-deps.
      #
      #  pull_request.sender

      - name: Checkout this repo
        uses: actions/checkout@v3
        with:
          ref: ${{ github.event.repository.default_branch }}
          # Fetch all history, so rev-parse HEAD is real HEAD,
          # and we get tag history.
          fetch-depth: 0
